/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=30)}([function(e,t){e.exports=__kbnSharedDeps__.Lodash},function(e,t,n){e.exports=n(7)(1075)},function(e,t,n){e.exports=n(7)(2399)},function(e,t,n){e.exports=n(7)(2404)},function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t){e.exports=__kbnSharedDeps__.RxjsOperators},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/embeddable/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/embeddableEnhanced/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t,n){e.exports=n(7)(2401)},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/data/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){e.exports=n(7)(2403)},function(e,t,n){e.exports=n(7)(495)},function(e,t){e.exports=__kbnSharedDeps__.Rxjs},function(e,t,n){e.exports=n(7)(1073)},function(e,t,n){"use strict";function r(e,t,n,o){var a=Error.call(this,e);return Object.setPrototypeOf&&Object.setPrototypeOf(a,r.prototype),a.expected=t,a.found=n,a.location=o,a.name="SyntaxError",a}function o(e,t,n){return n=n||" ",e.length>t?e:(t-=e.length,e+(n+=n.repeat(t)).slice(0,t))}!function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}(r,Error),r.prototype.format=function(e){var t="Error: "+this.message;if(this.location){var n,r=null;for(n=0;n<e.length;n++)if(e[n].source===this.location.source){r=e[n].text.split(/\r\n|\n|\r/g);break}var a=this.location.start,i=this.location.source+":"+a.line+":"+a.column;if(r){var s=this.location.end,u=o("",a.line.toString().length),c=r[a.line-1],l=a.line===s.line?s.column:c.length+1;t+="\n --\x3e "+i+"\n"+u+" |\n"+a.line+" | "+c+"\n"+u+" | "+o("",a.column-1)+o("",l-a.column,"^")}else t+="\n at "+i}return t},r.buildMessage=function(e,t){var n={literal:function(e){return'"'+o(e.text)+'"'},class:function(e){var t=e.parts.map((function(e){return Array.isArray(e)?a(e[0])+"-"+a(e[1]):a(e)}));return"["+(e.inverted?"^":"")+t+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(e){return e.description}};function r(e){return e.charCodeAt(0).toString(16).toUpperCase()}function o(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+r(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+r(e)}))}function a(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+r(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+r(e)}))}function i(e){return n[e.type](e)}return"Expected "+function(e){var t,n,r=e.map(i);if(r.sort(),r.length>0){for(t=1,n=1;t<r.length;t++)r[t-1]!==r[t]&&(r[n]=r[t],n++);r.length=n}switch(r.length){case 1:return r[0];case 2:return r[0]+" or "+r[1];default:return r.slice(0,-1).join(", ")+", or "+r[r.length-1]}}(e)+" but "+function(e){return e?'"'+o(e)+'"':"end of input"}(t)+" found."},e.exports={SyntaxError:r,parse:function(e,t){var n,o={},a=(t=void 0!==t?t:{}).grammarSource,i={start:at,Literal:mt},s=at,u="(",c=")",l=":",d="{",f="}",p="or",h="and",b="not",g='"',v="\\",m="*",y="\\t",_="\\r",w="\\n",j="u",x="<=",E=">=",C="<",O=">",D="@kuery-cursor@",A=/^[\\"]/,T=/^[^"]/,I=/^[\\():<>"*{}]/,S=/^[0-9a-f]/i,R=/^[ \t\r\n\xA0]/,N=Ze("(",!1),F=Ze(")",!1),k=Ze(":",!1),L=Ze("{",!1),P=Ze("}",!1),M=et("fieldName"),U=et("value"),Q=et("OR"),G=Ze("or",!0),q=et("AND"),B=Ze("and",!0),$=et("NOT"),W=Ze("not",!0),K=et("literal"),V=Ze('"',!1),H=Ze("\\",!1),Y=Je(["\\",'"'],!1,!1),z=Je(['"'],!0,!1),X={type:"any"},Z=Ze("*",!1),J=Ze("\\t",!1),ee=Ze("\\r",!1),te=Ze("\\n",!1),ne=Je(["\\","(",")",":","<",">",'"',"*","{","}"],!1,!1),re=Ze("u",!1),oe=Je([["0","9"],["a","f"]],!1,!0),ae=Ze("<=",!1),ie=Ze(">=",!1),se=Ze("<",!1),ue=Ze(">",!1),ce=et("whitespace"),le=Je([" ","\t","\r","\n","Â "],!1,!1),de=Ze("@kuery-cursor@",!1),fe=function(e,t){return"cursor"===t.type?{...t,suggestionTypes:["conjunction"]}:null!==e?e:Nt.function.buildNode("is","*","*")},pe=function(e,t){return t},he=function(e,t){const n=[e,...t],r=It&&n.find((e=>"cursor"===e.type));return r||Ft("or",n)},be=function(e,t){const n=[e,...t],r=It&&n.find((e=>"cursor"===e.type));return r||Ft("and",n)},ge=function(e){return"cursor"===e.type?e:Ft("not",[e])},ve=function(e,t){return"cursor"===t.type?{...t,suggestionTypes:["conjunction"]}:e},me=function(e,t,n){return"cursor"===t.type?{...t,nestedPath:t.nestedPath?`${e.value}.${t.nestedPath}`:e.value}:"cursor"===n.type?{...n,suggestionTypes:["conjunction"]}:Ft("nested",[e,t])},ye=function(e,t,n){if("cursor"===n.type)return{...n,suggestionTypes:["conjunction"]};const r=Pt(t,n);return Ft("range",[e,r])},_e=function(e,t){return"cursor"===t.type?{...t,fieldName:e.value,suggestionTypes:["value","conjunction"]}:t(e)},we=function(e){if("cursor"===e.type){const t=`${e.prefix}${e.suffix}`.trim();return{...e,fieldName:t,suggestionTypes:["field","operator","conjunction"]}}return e(kt(null))},je=function(e,t){return"cursor"===t.type?{...t,suggestionTypes:["conjunction"]}:e},xe=function(e,t){return t},Ee=function(e,t){const n=[e,...t],r=It&&n.find((e=>"cursor"===e.type));return r?{...r,suggestionTypes:["value"]}:e=>Ft("or",n.map((t=>t(e))))},Ce=function(e,t){const n=[e,...t],r=It&&n.find((e=>"cursor"===e.type));return r?{...r,suggestionTypes:["value"]}:e=>Ft("and",n.map((t=>t(e))))},Oe=function(e){return"cursor"===e.type?{...list,suggestionTypes:["value"]}:t=>Ft("not",[e(t)])},De=function(e){if("cursor"===e.type)return e;const t=kt(!0);return n=>Ft("is",[n,e,t])},Ae=function(e){if("cursor"===e.type)return e;!Rt&&"wildcard"===e.type&&Nt.wildcard.hasLeadingWildcard(e)&&function(e,t){throw t=void 0!==t?t:nt(Ve,Ke),function(e,t){return new r(e,null,null,t)}(e,t)}("Leading wildcards are disabled. See query:allowLeadingWildcards in Advanced Settings.");const t=kt(!1);return n=>Ft("is",[n,e,t])},Te=function(){return It},Ie=function(t,n,r){const{start:o,end:a}=nt(Ve,Ke);return{type:"cursor",start:o.offset,end:a.offset-n.length,prefix:t.join(""),suffix:r.join(""),text:e.substring(Ve,Ke).replace(n,"")}},Se=function(e){return kt(e.join(""))},Re=function(e){return e},Ne=function(e){const t=e.join("").trim();return"null"===t?kt(null):"true"===t?kt(!0):"false"===t?kt(!1):e.includes(Mt)?Lt(t):kt(t)},Fe=function(){return Mt},ke=function(){return"\t"},Le=function(){return"\r"},Pe=function(){return"\n"},Me=function(e){return e},Ue=function(e){return e},Qe=function(e){return String.fromCharCode(parseInt(e,16))},Ge=function(){return"lte"},qe=function(){return"gte"},Be=function(){return"lt"},$e=function(){return"gt"},We=function(){return St},Ke=0,Ve=0,He=[{line:1,column:1}],Ye=0,ze=[],Xe=0;if("startRule"in t){if(!(t.startRule in i))throw new Error("Can't start parsing from rule \""+t.startRule+'".');s=i[t.startRule]}function Ze(e,t){return{type:"literal",text:e,ignoreCase:t}}function Je(e,t,n){return{type:"class",parts:e,inverted:t,ignoreCase:n}}function et(e){return{type:"other",description:e}}function tt(t){var n,r=He[t];if(r)return r;for(n=t-1;!He[n];)n--;for(r={line:(r=He[n]).line,column:r.column};n<t;)10===e.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return He[t]=r,r}function nt(e,t){var n=tt(e),r=tt(t);return{source:a,start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:r.line,column:r.column}}}function rt(e){Ke<Ye||(Ke>Ye&&(Ye=Ke,ze=[]),ze.push(e))}function ot(e,t,n){return new r(r.buildMessage(e,t),e,t,n)}function at(){var e,t,n,r;for(e=Ke,t=[],n=At();n!==o;)t.push(n),n=At();return(n=it())===o&&(n=null),(r=xt())!==o?(Ve=e,e=fe(n,r)):(Ke=e,e=o),e}function it(){var e,t,n,r,a;if(e=Ke,(t=st())!==o){if(n=[],r=Ke,bt()!==o&&(a=st())!==o?(Ve=r,r=pe(t,a)):(Ke=r,r=o),r!==o)for(;r!==o;)n.push(r),r=Ke,bt()!==o&&(a=st())!==o?(Ve=r,r=pe(t,a)):(Ke=r,r=o);else n=o;n!==o?(Ve=e,e=he(t,n)):(Ke=e,e=o)}else Ke=e,e=o;return e===o&&(e=st()),e}function st(){var e,t,n,r,a;if(e=Ke,(t=ut())!==o){if(n=[],r=Ke,gt()!==o&&(a=ut())!==o?(Ve=r,r=pe(t,a)):(Ke=r,r=o),r!==o)for(;r!==o;)n.push(r),r=Ke,gt()!==o&&(a=ut())!==o?(Ve=r,r=pe(t,a)):(Ke=r,r=o);else n=o;n!==o?(Ve=e,e=be(t,n)):(Ke=e,e=o)}else Ke=e,e=o;return e===o&&(e=ut()),e}function ut(){var e,t;return e=Ke,vt()!==o&&(t=ct())!==o?(Ve=e,e=ge(t)):(Ke=e,e=o),e===o&&(e=ct()),e}function ct(){var t,n,r,a,i,s;if(t=Ke,40===e.charCodeAt(Ke)?(n=u,Ke++):(n=o,0===Xe&&rt(N)),n!==o){for(r=[],a=At();a!==o;)r.push(a),a=At();(a=it())!==o&&(i=xt())!==o?(41===e.charCodeAt(Ke)?(s=c,Ke++):(s=o,0===Xe&&rt(F)),s!==o?(Ve=t,t=ve(a,i)):(Ke=t,t=o)):(Ke=t,t=o)}else Ke=t,t=o;return t===o&&(t=function(){var t,n,r,a,i,s,u,c,p,h;if(t=Ke,n=lt(),n!==o){for(r=[],a=At();a!==o;)r.push(a),a=At();if(58===e.charCodeAt(Ke)?(a=l,Ke++):(a=o,0===Xe&&rt(k)),a!==o){for(i=[],s=At();s!==o;)i.push(s),s=At();if(123===e.charCodeAt(Ke)?(s=d,Ke++):(s=o,0===Xe&&rt(L)),s!==o){for(u=[],c=At();c!==o;)u.push(c),c=At();(c=it())!==o&&(p=xt())!==o?(125===e.charCodeAt(Ke)?(h=f,Ke++):(h=o,0===Xe&&rt(P)),h!==o?(Ve=t,t=me(n,c,p)):(Ke=t,t=o)):(Ke=t,t=o)}else Ke=t,t=o}else Ke=t,t=o}else Ke=t,t=o;t===o&&(t=function(){var t;t=function(){var t,n,r,a,i,s;if(t=Ke,n=lt(),n!==o){for(r=[],a=At();a!==o;)r.push(a),a=At();if(a=function(){var t,n;t=Ke,e.substr(Ke,2)===x?(n=x,Ke+=2):(n=o,0===Xe&&rt(ae));n!==o&&(Ve=t,n=Ge());t=n,t===o&&(t=Ke,e.substr(Ke,2)===E?(n=E,Ke+=2):(n=o,0===Xe&&rt(ie)),n!==o&&(Ve=t,n=qe()),(t=n)===o&&(t=Ke,60===e.charCodeAt(Ke)?(n=C,Ke++):(n=o,0===Xe&&rt(se)),n!==o&&(Ve=t,n=Be()),(t=n)===o&&(t=Ke,62===e.charCodeAt(Ke)?(n=O,Ke++):(n=o,0===Xe&&rt(ue)),n!==o&&(Ve=t,n=$e()),t=n)));return t}(),a!==o){for(i=[],s=At();s!==o;)i.push(s),s=At();(s=mt())!==o?(Ve=t,t=ye(n,a,s)):(Ke=t,t=o)}else Ke=t,t=o}else Ke=t,t=o;return t}(),t===o&&(t=function(){var t,n,r,a,i,s;if(t=Ke,n=lt(),n!==o){for(r=[],a=At();a!==o;)r.push(a),a=At();if(58===e.charCodeAt(Ke)?(a=l,Ke++):(a=o,0===Xe&&rt(k)),a!==o){for(i=[],s=At();s!==o;)i.push(s),s=At();(s=dt())!==o?(Ve=t,t=_e(n,s)):(Ke=t,t=o)}else Ke=t,t=o}else Ke=t,t=o;return t}(),t===o&&(t=function(){var e,t;e=Ke,t=ht(),t!==o&&(Ve=e,t=we(t));return e=t,e}()));return t}());return t}()),t}function lt(){var e;return Xe++,e=mt(),Xe--,e===o&&(o,0===Xe&&rt(M)),e}function dt(){var t,n,r,a,i,s;if(t=Ke,40===e.charCodeAt(Ke)?(n=u,Ke++):(n=o,0===Xe&&rt(N)),n!==o){for(r=[],a=At();a!==o;)r.push(a),a=At();a=function(){var e,t,n,r,a;if(e=Ke,t=ft(),t!==o){if(n=[],r=Ke,bt()!==o&&(a=ft())!==o?(Ve=r,r=xe(t,a)):(Ke=r,r=o),r!==o)for(;r!==o;)n.push(r),r=Ke,bt()!==o&&(a=ft())!==o?(Ve=r,r=xe(t,a)):(Ke=r,r=o);else n=o;n!==o?(Ve=e,e=Ee(t,n)):(Ke=e,e=o)}else Ke=e,e=o;e===o&&(e=ft());return e}(),a!==o&&(i=xt())!==o?(41===e.charCodeAt(Ke)?(s=c,Ke++):(s=o,0===Xe&&rt(F)),s!==o?(Ve=t,t=je(a,i)):(Ke=t,t=o)):(Ke=t,t=o)}else Ke=t,t=o;return t===o&&(t=ht()),t}function ft(){var e,t,n,r,a;if(e=Ke,(t=pt())!==o){if(n=[],r=Ke,gt()!==o&&(a=pt())!==o?(Ve=r,r=xe(t,a)):(Ke=r,r=o),r!==o)for(;r!==o;)n.push(r),r=Ke,gt()!==o&&(a=pt())!==o?(Ve=r,r=xe(t,a)):(Ke=r,r=o);else n=o;n!==o?(Ve=e,e=Ce(t,n)):(Ke=e,e=o)}else Ke=e,e=o;return e===o&&(e=pt()),e}function pt(){var e,t;return e=Ke,vt()!==o&&(t=dt())!==o?(Ve=e,e=Oe(t)):(Ke=e,e=o),e===o&&(e=dt()),e}function ht(){var e,t;return Xe++,e=Ke,(t=yt())!==o&&(Ve=e,t=De(t)),(e=t)===o&&(e=Ke,(t=wt())!==o&&(Ve=e,t=Ae(t)),e=t),Xe--,e===o&&(t=o,0===Xe&&rt(U)),e}function bt(){var t,n,r,a,i;if(Xe++,t=Ke,n=[],(r=At())!==o)for(;r!==o;)n.push(r),r=At();else n=o;if(n!==o)if(e.substr(Ke,2).toLowerCase()===p?(r=e.substr(Ke,2),Ke+=2):(r=o,0===Xe&&rt(G)),r!==o){if(a=[],(i=At())!==o)for(;i!==o;)a.push(i),i=At();else a=o;a!==o?t=n=[n,r,a]:(Ke=t,t=o)}else Ke=t,t=o;else Ke=t,t=o;return Xe--,t===o&&(n=o,0===Xe&&rt(Q)),t}function gt(){var t,n,r,a,i;if(Xe++,t=Ke,n=[],(r=At())!==o)for(;r!==o;)n.push(r),r=At();else n=o;if(n!==o)if(e.substr(Ke,3).toLowerCase()===h?(r=e.substr(Ke,3),Ke+=3):(r=o,0===Xe&&rt(B)),r!==o){if(a=[],(i=At())!==o)for(;i!==o;)a.push(i),i=At();else a=o;a!==o?t=n=[n,r,a]:(Ke=t,t=o)}else Ke=t,t=o;else Ke=t,t=o;return Xe--,t===o&&(n=o,0===Xe&&rt(q)),t}function vt(){var t,n,r,a;if(Xe++,t=Ke,e.substr(Ke,3).toLowerCase()===b?(n=e.substr(Ke,3),Ke+=3):(n=o,0===Xe&&rt(W)),n!==o){if(r=[],(a=At())!==o)for(;a!==o;)r.push(a),a=At();else r=o;r!==o?t=n=[n,r]:(Ke=t,t=o)}else Ke=t,t=o;return Xe--,t===o&&(n=o,0===Xe&&rt($)),t}function mt(){var e;return Xe++,(e=yt())===o&&(e=wt()),Xe--,e===o&&(o,0===Xe&&rt(K)),e}function yt(){var t,n,r,a,i,s,u;if(t=Ke,Ve=Ke,(n=(n=Te())?void 0:o)!==o)if(34===e.charCodeAt(Ke)?(r=g,Ke++):(r=o,0===Xe&&rt(V)),r!==o){for(a=[],i=_t();i!==o;)a.push(i),i=_t();if((i=Tt())!==o){for(s=[],u=_t();u!==o;)s.push(u),u=_t();34===e.charCodeAt(Ke)?(u=g,Ke++):(u=o,0===Xe&&rt(V)),u!==o?(Ve=t,t=Ie(a,i,s)):(Ke=t,t=o)}else Ke=t,t=o}else Ke=t,t=o;else Ke=t,t=o;if(t===o)if(t=Ke,34===e.charCodeAt(Ke)?(n=g,Ke++):(n=o,0===Xe&&rt(V)),n!==o){for(r=[],a=_t();a!==o;)r.push(a),a=_t();34===e.charCodeAt(Ke)?(a=g,Ke++):(a=o,0===Xe&&rt(V)),a!==o?(Ve=t,t=Se(r)):(Ke=t,t=o)}else Ke=t,t=o;return t}function _t(){var t,n,r;return(t=Et())===o&&(t=Ot())===o&&(t=Ke,92===e.charCodeAt(Ke)?(n=v,Ke++):(n=o,0===Xe&&rt(H)),n!==o?(A.test(e.charAt(Ke))?(r=e.charAt(Ke),Ke++):(r=o,0===Xe&&rt(Y)),r!==o?(Ve=t,t=Re(r)):(Ke=t,t=o)):(Ke=t,t=o),t===o&&(t=Ke,n=Ke,Xe++,r=Tt(),Xe--,r===o?n=void 0:(Ke=n,n=o),n!==o?(T.test(e.charAt(Ke))?(r=e.charAt(Ke),Ke++):(r=o,0===Xe&&rt(z)),r!==o?(Ve=t,t=Re(r)):(Ke=t,t=o)):(Ke=t,t=o))),t}function wt(){var e,t,n,r,a,i;if(e=Ke,Ve=Ke,(t=(t=Te())?void 0:o)!==o){for(n=[],r=jt();r!==o;)n.push(r),r=jt();if((r=Tt())!==o){for(a=[],i=jt();i!==o;)a.push(i),i=jt();Ve=e,e=Ie(n,r,a)}else Ke=e,e=o}else Ke=e,e=o;if(e===o){if(e=Ke,t=[],(n=jt())!==o)for(;n!==o;)t.push(n),n=jt();else t=o;t!==o&&(Ve=e,t=Ne(t)),e=t}return e}function jt(){var t,n,r,a,i;return(t=Et())===o&&(t=function(){var t,n,r;t=Ke,92===e.charCodeAt(Ke)?(n=v,Ke++):(n=o,0===Xe&&rt(H));n!==o&&(r=Ct())!==o?(Ve=t,t=Re(r)):(Ke=t,t=o);return t}(),t===o&&(t=Ot())===o&&(t=function(){var t,n,r;t=Ke,92===e.charCodeAt(Ke)?(n=v,Ke++):(n=o,0===Xe&&rt(H));n!==o?(e.substr(Ke,2).toLowerCase()===p?(r=e.substr(Ke,2),Ke+=2):(r=o,0===Xe&&rt(G)),r===o&&(e.substr(Ke,3).toLowerCase()===h?(r=e.substr(Ke,3),Ke+=3):(r=o,0===Xe&&rt(B)),r===o&&(e.substr(Ke,3).toLowerCase()===b?(r=e.substr(Ke,3),Ke+=3):(r=o,0===Xe&&rt(W)))),r!==o?(Ve=t,t=Me(r)):(Ke=t,t=o)):(Ke=t,t=o);return t}(),t===o&&(t=function(){var t,n;t=Ke,42===e.charCodeAt(Ke)?(n=m,Ke++):(n=o,0===Xe&&rt(Z));n!==o&&(Ve=t,n=Fe());return t=n,t}(),t===o&&(t=Ke,n=Ke,Xe++,r=Ct(),Xe--,r===o?n=void 0:(Ke=n,n=o),n!==o?(r=Ke,Xe++,a=function(){var e;e=bt(),e===o&&(e=gt())===o&&(e=vt());return e}(),Xe--,a===o?r=void 0:(Ke=r,r=o),r!==o?(a=Ke,Xe++,i=Tt(),Xe--,i===o?a=void 0:(Ke=a,a=o),a!==o?(e.length>Ke?(i=e.charAt(Ke),Ke++):(i=o,0===Xe&&rt(X)),i!==o?(Ve=t,t=Re(i)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o))))),t}function xt(){var e,t,n,r,a,i;if(e=Ke,Ve=Ke,(t=(t=Te())?void 0:o)!==o){for(n=[],r=At();r!==o;)n.push(r),r=At();if((r=Tt())!==o){for(a=[],i=At();i!==o;)a.push(i),i=At();Ve=e,e=Ie(n,r,a)}else Ke=e,e=o}else Ke=e,e=o;if(e===o)for(e=[],t=At();t!==o;)e.push(t),t=At();return e}function Et(){var t,n;return t=Ke,e.substr(Ke,2)===y?(n=y,Ke+=2):(n=o,0===Xe&&rt(J)),n!==o&&(Ve=t,n=ke()),(t=n)===o&&(t=Ke,e.substr(Ke,2)===_?(n=_,Ke+=2):(n=o,0===Xe&&rt(ee)),n!==o&&(Ve=t,n=Le()),(t=n)===o&&(t=Ke,e.substr(Ke,2)===w?(n=w,Ke+=2):(n=o,0===Xe&&rt(te)),n!==o&&(Ve=t,n=Pe()),t=n)),t}function Ct(){var t;return I.test(e.charAt(Ke))?(t=e.charAt(Ke),Ke++):(t=o,0===Xe&&rt(ne)),t}function Ot(){var t,n,r;return t=Ke,92===e.charCodeAt(Ke)?(n=v,Ke++):(n=o,0===Xe&&rt(H)),n!==o?(r=function(){var t,n,r,a,i,s,u,c;t=Ke,117===e.charCodeAt(Ke)?(n=j,Ke++):(n=o,0===Xe&&rt(re));n!==o?(r=Ke,a=Ke,(i=Dt())!==o&&(s=Dt())!==o&&(u=Dt())!==o&&(c=Dt())!==o?a=i=[i,s,u,c]:(Ke=a,a=o),(r=a!==o?e.substring(r,Ke):a)!==o?(Ve=t,t=Qe(r)):(Ke=t,t=o)):(Ke=t,t=o);return t}(),r!==o?(Ve=t,t=Ue(r)):(Ke=t,t=o)):(Ke=t,t=o),t}function Dt(){var t;return S.test(e.charAt(Ke))?(t=e.charAt(Ke),Ke++):(t=o,0===Xe&&rt(oe)),t}function At(){var t;return Xe++,R.test(e.charAt(Ke))?(t=e.charAt(Ke),Ke++):(t=o,0===Xe&&rt(le)),Xe--,t===o&&(o,0===Xe&&rt(ce)),t}function Tt(){var t,n;return t=Ke,Ve=Ke,(Te()?void 0:o)!==o?(e.substr(Ke,14)===D?(n=D,Ke+=14):(n=o,0===Xe&&rt(de)),n!==o?(Ve=t,t=We()):(Ke=t,t=o)):(Ke=t,t=o),t}const{parseCursor:It,cursorSymbol:St,allowLeadingWildcards:Rt=!0,helpers:{nodeTypes:Nt}}=t,Ft=Nt.function.buildNodeWithArgumentNodes,kt=Nt.literal.buildNode,Lt=Nt.wildcard.buildNode,Pt=Nt.namedArg.buildNode,{wildcardSymbol:Mt}=Nt.wildcard;if((n=s())!==o&&Ke===e.length)return n;throw n!==o&&Ke<e.length&&rt({type:"end"}),ot(ze,Ye<e.length?e.charAt(Ye):null,Ye<e.length?nt(Ye,Ye+1):nt(Ye,Ye))}}},function(e,t){e.exports=__kbnSharedDeps__.MomentTimezone},function(e,t,n){var r=n(32);function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,r(o.key),o)}}e.exports=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){e.exports=n(7)(2387)},function(e,t,n){e.exports=n(7)(2394)},function(e,t,n){e.exports=n(7)(1074)},function(e,t,n){e.exports=n(7)(2397)},function(e,t,n){e.exports=n(7)(2407)},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/dashboard/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){e.exports=n(7)(1076)},function(e,t,n){n(31),__kbnBundles__.define("plugin/dashboardEnhanced/public",n,33)},function(e,t,n){n.p=window.__kbnPublicPath__.dashboardEnhanced},function(e,t,n){e.exports=n(7)(2395)},function(e,t,n){"use strict";n.r(t),n.d(t,"DashboardEnhancedAbstractDashboardDrilldown",(function(){return abstract_dashboard_drilldown_AbstractDashboardDrilldown})),n.d(t,"plugin",(function(){return jt}));var r={};n.r(r),n.d(r,"buildNode",(function(){return ne})),n.d(r,"toElasticsearchQuery",(function(){return re}));var o={};n.r(o),n.d(o,"wildcardSymbol",(function(){return oe})),n.d(o,"buildNode",(function(){return se})),n.d(o,"test",(function(){return ue})),n.d(o,"toElasticsearchQuery",(function(){return ce})),n.d(o,"toQueryStringQuery",(function(){return le})),n.d(o,"hasLeadingWildcard",(function(){return de}));var a={};n.r(a),n.d(a,"buildNodeParams",(function(){return me})),n.d(a,"toElasticsearchQuery",(function(){return ye}));var i={};n.r(i),n.d(i,"buildNodeParams",(function(){return _e})),n.d(i,"toElasticsearchQuery",(function(){return we}));var s={};n.r(s),n.d(s,"buildNodeParams",(function(){return je})),n.d(s,"toElasticsearchQuery",(function(){return xe}));var u={};n.r(u),n.d(u,"buildNodeParams",(function(){return Ee})),n.d(u,"toElasticsearchQuery",(function(){return Ce}));var c={};n.r(c),n.d(c,"buildNodeParams",(function(){return Ae})),n.d(c,"toElasticsearchQuery",(function(){return Te}));var l={};n.r(l),n.d(l,"buildNodeParams",(function(){return Ie})),n.d(l,"toElasticsearchQuery",(function(){return Se}));var d={};n.r(d),n.d(d,"buildNodeParams",(function(){return Re})),n.d(d,"toElasticsearchQuery",(function(){return Ne}));var f={};n.r(f),n.d(f,"buildNodeParams",(function(){return Fe})),n.d(f,"toElasticsearchQuery",(function(){return ke}));var p={};n.r(p),n.d(p,"buildNodeParams",(function(){return Le})),n.d(p,"toElasticsearchQuery",(function(){return Pe}));var h={};n.r(h),n.d(h,"buildNode",(function(){return Ue})),n.d(h,"buildNodeWithArgumentNodes",(function(){return Qe})),n.d(h,"toElasticsearchQuery",(function(){return Ge}));var b={};n.r(b),n.d(b,"buildNode",(function(){return qe})),n.d(b,"toElasticsearchQuery",(function(){return Be}));var g=n(1),v=n.n(g),m=n(8),y=n(11),_=n.n(y),w=n(5),j=n(6),x=n(18),E=n(14),C=n(10),O=n(13);function D(e){return e.includes(O.APPLY_FILTER_TRIGGER)||!e.includes(m.VALUE_CLICK_TRIGGER)&&!e.includes(m.SELECT_RANGE_TRIGGER)?e:[...e,O.APPLY_FILTER_TRIGGER]}const A=e=>{const t=[],n=e.id,r=e.getRoot();if(!r)return t;if(!(r instanceof m.Container))return t;const o=r.getChildIds();for(const e of o){const o=r.getChild(e);if(o.id===n)continue;if(!Object(C.isEnhancedEmbeddable)(o))continue;const a=o.enhancements.dynamicActions.state.get().events;for(const e of a){const n={id:e.eventId,name:e.action.name,icon:"dashboardApp",description:o.getTitle()||o.id,config:e.action.config,factoryId:e.action.factoryId,triggers:e.triggers};t.push(n)}}return t};var T=n(4);const I="OPEN_FLYOUT_ADD_DRILLDOWN";class flyout_create_drilldown_FlyoutCreateDrilldownAction{constructor(e){v()(this,"type",I),v()(this,"id",I),v()(this,"order",12),v()(this,"grouping",C.embeddableEnhancedDrilldownGrouping),this.params=e}getDisplayName(){return w.i18n.translate("xpack.dashboard.FlyoutCreateDrilldownAction.displayName",{defaultMessage:"Create drilldown"})}getIconType(){return"plusInCircle"}isEmbeddableCompatible(e){if(!Object(C.isEnhancedEmbeddable)(e.embeddable))return!1;const t=e.embeddable.supportedTriggers();if(!t||!t.length)return!1;if("dashboard"!==e.embeddable.getRoot().type)return!1;const n=this.params.start().plugins.uiActionsEnhanced.getActionFactories().map((e=>e.supportedTriggers())).reduce(((e,t)=>e.concat(t)),[]);return D(t).some((e=>n.includes(e)))}async isCompatible(e){return"edit"===e.embeddable.getInput().viewMode&&this.isEmbeddableCompatible(e)}async execute(e){const{core:t,plugins:n}=this.params.start(),{embeddable:r}=e;if(!Object(C.isEnhancedEmbeddable)(r))throw new Error("Need embeddable to be EnhancedEmbeddable to execute FlyoutCreateDrilldownAction.");const o=A(r),a=new x.Subject,i=()=>{a.next(!0),s.close()},s=t.overlays.openFlyout(Object(E.toMountPoint)(Object(T.jsx)(n.uiActionsEnhanced.DrilldownManager,{closeAfterCreate:!0,initialRoute:"/new",dynamicActionManager:r.enhancements.dynamicActions,triggers:[...D(r.supportedTriggers()),m.CONTEXT_MENU_TRIGGER],placeContext:{embeddable:r},templates:o,onClose:i})),{ownFocus:!0,"data-test-subj":"createDrilldownFlyout"});t.application.currentAppId$.pipe(Object(j.takeUntil)(a),Object(j.skip)(1),Object(j.take)(1)).subscribe((()=>{i()})),r.getInput$().pipe(Object(j.takeUntil)(a),Object(j.map)((e=>e.viewMode)),Object(j.distinctUntilChanged)(),Object(j.filter)((e=>e!==m.ViewMode.EDIT)),Object(j.take)(1)).subscribe((()=>{i()}))}}const S=w.i18n.translate("xpack.dashboard.panel.openFlyoutEditDrilldown.displayName",{defaultMessage:"Manage drilldowns"});var R=n(9),N=n(15);const F=({context:e})=>{const{events:t}=Object(N.useContainerState)(e.embeddable.enhancements.dynamicActions.state),n=t.length;return Object(T.jsx)(R.EuiFlexGroup,{alignItems:"center"},Object(T.jsx)(R.EuiFlexItem,{grow:!0},S),n>0&&Object(T.jsx)(R.EuiFlexItem,{grow:!1},Object(T.jsx)(R.EuiNotificationBadge,null,n)))},k="OPEN_FLYOUT_EDIT_DRILLDOWN";class flyout_edit_drilldown_FlyoutEditDrilldownAction{constructor(e){v()(this,"type",k),v()(this,"id",k),v()(this,"order",10),v()(this,"grouping",C.embeddableEnhancedDrilldownGrouping),v()(this,"MenuItem",Object(E.reactToUiComponent)(F)),this.params=e}getDisplayName(){return S}getIconType(){return"list"}async isCompatible({embeddable:e}){return e.getInput().viewMode===m.ViewMode.EDIT&&(!!Object(C.isEnhancedEmbeddable)(e)&&e.enhancements.dynamicActions.state.get().events.length>0)}async execute(e){const{core:t,plugins:n}=this.params.start(),{embeddable:r}=e;if(!Object(C.isEnhancedEmbeddable)(r))throw new Error("Need embeddable to be EnhancedEmbeddable to execute FlyoutEditDrilldownAction.");const o=A(r),a=new x.Subject,i=()=>{a.next(!0),s.close()},s=t.overlays.openFlyout(Object(E.toMountPoint)(Object(T.jsx)(n.uiActionsEnhanced.DrilldownManager,{initialRoute:"/manage",dynamicActionManager:r.enhancements.dynamicActions,triggers:[...D(r.supportedTriggers()),m.CONTEXT_MENU_TRIGGER],placeContext:{embeddable:r},templates:o,onClose:i})),{ownFocus:!0,"data-test-subj":"editDrilldownFlyout"});t.application.currentAppId$.pipe(Object(j.takeUntil)(a),Object(j.skip)(1),Object(j.take)(1)).subscribe((()=>{i()})),r.getInput$().pipe(Object(j.takeUntil)(a),Object(j.map)((e=>e.viewMode)),Object(j.distinctUntilChanged)(),Object(j.filter)((e=>e!==m.ViewMode.EDIT)),Object(j.take)(1)).subscribe((()=>{i()}))}}var L=n(2),P=n.n(L),M=n(0),U=n.n(M),Q=n(17),G=n.n(Q),q=function(e,t){if("boolean"!=typeof t&&"boolean"===e.type){if([1,"true"].includes(t))return!0;if([0,"false"].includes(t))return!1;throw new Error("".concat(t," is not a valid boolean value for boolean field ").concat(e.name))}return"number"!=typeof t&&"number"===e.type?Number(t):t},B=function(e,t){var n=q(e,t);return{script:{source:$(e),lang:e.lang,params:{value:n}}}},$=function(e){return"painless"===e.lang?"boolean compare(Supplier s, def v) {return s.get() == v;}"+"compare(() -> { ".concat(e.script," }, params.value);"):"(".concat(e.script,") == value")},W=function(e){return e.APP_STATE="appState",e.GLOBAL_STATE="globalState",e}({}),K={gt:">",gte:">=",lte:"<=",lt:"<"},V={gt:"boolean gt(Supplier s, def v) {return s.get() > v}",gte:"boolean gte(Supplier s, def v) {return s.get() >= v}",lte:"boolean lte(Supplier s, def v) {return s.get() <= v}",lt:"boolean lt(Supplier s, def v) {return s.get() < v}"},H={gt:"boolean gt(Supplier s, def v) {return s.get().toInstant().isAfter(Instant.parse(v))}",gte:"boolean gte(Supplier s, def v) {return !s.get().toInstant().isBefore(Instant.parse(v))}",lte:"boolean lte(Supplier s, def v) {return !s.get().toInstant().isAfter(Instant.parse(v))}",lt:"boolean lt(Supplier s, def v) {return s.get().toInstant().isBefore(Instant.parse(v))}"},Y=function(e,t){var n=Object(M.mapValues)(Object(M.pickBy)(t,(function(e,t){return t in K})),(function(t){return"number"===e.type&&"string"==typeof t?parseFloat(t):t})),r=Object(M.map)(n,(function(t,n){return"("+e.script+")"+Object(M.get)(K,n)+n})).join(" && ");if("painless"===e.lang){var o="date"===e.type?H:V,a=Object(M.reduce)(n,(function(e,t,n){return e.concat(Object(M.get)(o,n))}),[]).join(" "),i=Object(M.map)(n,(function(t,n){return"".concat(n,"(() -> { ").concat(e.script," }, params.").concat(n,")")})).join(" && ");r="".concat(a).concat(i)}return{script:{source:r,params:n,lang:e.lang}}};var z=function(e){return e.$state&&e.$state.store===W.GLOBAL_STATE},X=function(e){return Array.isArray(e)&&!e.find((function(e){return!function(e){return!!e&&"object"===G()(e)&&!!e.meta&&"object"===G()(e.meta)&&"boolean"==typeof e.meta.disabled}(e)}))};var Z=n(3),J=n.n(Z),ee=n(12),te=n.n(ee);function ne(e){return{type:"literal",value:e}}function re(e){return e.value}var oe="@kuery-wildcard@";function ae(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ie(e){return e.replace(/[+\-=&|><!(){}[\]^"~*?:\\/]/g,"\\$&")}function se(e){return e.includes(oe)?{type:"wildcard",value:e}:ct(e)}function ue(e,t){var n=e.value.split(oe).map(ae).join("[\\s\\S]*");return new RegExp("^".concat(n,"$")).test(t)}function ce(e){return e.value.split(oe).join("*")}function le(e){return e.value.split(oe).map(ie).join("*")}function de(e){var t=e.value;return t.startsWith(oe)&&t.replace(oe,"").length>0}function fe(e,t){if(!t)return[];if("literal"===e.type){var n=re(e),r=t.fields.find((function(e){return e.name===n}));return r?[r]:[]}return"wildcard"===e.type?t.fields.filter((function(t){return ue(e,t.name)})):void 0}var pe=n(21),he=n.n(pe);function be(e){var t=he.a.tz.guess();return"Browser"===e?t:e}function ge(e){return function(e){var t,n=null==e?void 0:e.subType;return!(null==n||null===(t=n.nested)||void 0===t||!t.path)}(e)?e.subType:void 0}function ve(e,t,n){var r=P()(P()({},e),{},{value:n?"".concat(n,".").concat(e.value):e.value});if(!t||"wildcard"===r.type&&!n)return r;var o=fe(r,t).reduce((function(e,t){var r=ge(t),o=null==r?void 0:r.nested.path;return n&&!o?[].concat(J()(e),["".concat(t.name,' is not a nested field but is in nested group "').concat(n,'" in the KQL expression.')]):o&&!n?[].concat(J()(e),["".concat(t.name," is a nested field, but is not in a nested group in the KQL expression.")]):o!==n?[].concat(J()(e),["Nested field ".concat(t.name," is being queried with the incorrect nested path. The correct path is ").concat(null==r?void 0:r.nested.path,".")]):e}),[]);if(o.length>0)throw new Error(o.join("\n"));return r}function me(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Object(M.isUndefined)(e))throw new Error("fieldName is a required argument");if(Object(M.isUndefined)(t))throw new Error("value is a required argument");return{arguments:["string"==typeof e?ct(e):ne(e),"string"==typeof t?ct(t):ne(t),ne(n)]}}function ye(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=te()(e.arguments,3),a=o[0],i=o[1],s=o[2],u="wildcard"===i.type&&i.value===oe,c="wildcard"===a.type&&a.value===oe;if(u&&c)return{match_all:{}};var l=ve(a,t,null!=r&&r.nested?r.nested.path:void 0),d=Object(M.isUndefined)(i)?i:lt(i),f=s.value?"phrase":"best_fields";if(null===l.value)return"wildcard"===i.type?{query_string:{query:le(i)}}:{multi_match:{type:f,query:d,lenient:!0}};var p=t?fe(l,t):[];return p&&0===p.length&&p.push({name:lt(l),scripted:!1,type:""}),!u||null!=p&&p.length&&(null==p?void 0:p.length)!==(null==t?void 0:t.fields.length)?{bool:{should:p.reduce((function(e,t){var o=function(e){var n=ge(t);return"wildcard"!==l.type||null==n||!n.nested||null!=r&&r.nested?e:{nested:{path:n.nested.path,query:e,score_mode:"none"}}};if(!t.scripted){if(u)return[].concat(J()(e),[o({exists:{field:t.name}})]);if("wildcard"===i.type)return[].concat(J()(e),[o({query_string:{fields:[t.name],query:le(i)}})]);if("date"===t.type){var a=n.dateFormatTZ?{time_zone:be(n.dateFormatTZ)}:{};return[].concat(J()(e),[o({range:v()({},t.name,P()({gte:d,lte:d},a))})])}var s="phrase"===f?"match_phrase":"match";return[].concat(J()(e),[o(v()({},s,v()({},t.name,d)))])}if(!u)return[].concat(J()(e),[{script:P()({},B(t,d))}])}),[])||[],minimum_should_match:1}}:{match_all:{}}}function _e(e){return{arguments:e}}function we(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=n.filtersInMustClause,a=e.arguments||[],i=o?"must":"filter";return{bool:v()({},i,a.map((function(e){return lt(e,t,n,r)})))}}function je(e){return{arguments:e}}function xe(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return{bool:{should:(e.arguments||[]).map((function(e){return lt(e,t,n,r)})),minimum_should_match:1}}}function Ee(e){return{arguments:[e]}}function Ce(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=te()(e.arguments,1)[0];return{bool:{must_not:lt(o,t,n,r)}}}var Oe=n(16),De=n.n(Oe);function Ae(e,t){var n=Object(M.pick)(t,"gt","lt","gte","lte","format"),r="string"==typeof e?ct(e):$e.literal.buildNode(e),o=Object(M.map)(n,(function(e,t){return $e.namedArg.buildNode(t,e)}));return{arguments:[r].concat(J()(o))}}function Te(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=De()(e.arguments),a=o[0],i=o.slice(1),s=ve(a,t,null!=r&&r.nested?r.nested.path:void 0),u=t?fe(s,t):[],c=function(e){if(e.gt&&e.gte||e.lt&&e.lte)throw new Error("range ends cannot be both inclusive and exclusive");var t=["gte","lte","format"];return e.reduce((function(e,n,r){return"namedArg"===n.type?e[n.name]=n.value:e[t[r]]=n,e}),{})}(i),l=Object(M.mapValues)(c,(function(e){return lt(e)}));return u&&0===u.length&&u.push({name:lt(s),scripted:!1,type:""}),{bool:{should:u.map((function(e){var t=function(t){var n=ge(e);return"wildcard"!==s.type||null==n||!n.nested||r.nested?t:{nested:{path:n.nested.path,query:t,score_mode:"none"}}};if(e.scripted)return{script:Y(e,l)};if("date"===e.type){var o=n.dateFormatTZ?{time_zone:be(n.dateFormatTZ)}:{};return t({range:v()({},e.name,P()(P()({},l),o))})}return t({range:v()({},e.name,l)})})),minimum_should_match:1}}}function Ie(e){return{arguments:[ne(e)]}}function Se(e,t){var n,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=te()(e.arguments,1)[0],a=re(P()(P()({},o),{},{value:null!=r&&r.nested?"".concat(r.nested.path,".").concat(o.value):o.value})),i=null==t||null===(n=t.fields)||void 0===n?void 0:n.find((function(e){return e.name===a}));if(null!=i&&i.scripted)throw new Error("Exists query does not support scripted fields");return{exists:{field:a}}}function Re(e,t){t=U.a.pick(t,"topLeft","bottomRight");var n=$e.literal.buildNode(e),r=U.a.map(t,(function(e,t){var n="".concat(e.lat,", ").concat(e.lon);return $e.namedArg.buildNode(t,n)}));return{arguments:[n].concat(J()(r))}}function Ne(e,t){var n,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=De()(e.arguments),a=o[0],i=o.slice(1),s=P()(P()({},a),{},{value:null!=r&&r.nested?"".concat(r.nested.path,".").concat(a.value):a.value}),u=$e.literal.toElasticsearchQuery(s),c=(null!==(n=null==t?void 0:t.fields)&&void 0!==n?n:[]).find((function(e){return e.name===u})),l=i.reduce((function(e,t){var n=U.a.snakeCase(t.name);return P()(P()({},e),{},v()({},n,lt(t)))}),{});if(null!=c&&c.scripted)throw new Error("Geo bounding box query does not support scripted fields");return{geo_bounding_box:v()(v()({},u,l),"ignore_unmapped",!0)}}function Fe(e,t){var n=$e.literal.buildNode(e),r=t.map((function(e){var t="".concat(e.lat,", ").concat(e.lon);return $e.literal.buildNode(t)}));return{arguments:[n].concat(J()(r))}}function ke(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=De()(e.arguments),i=a[0],s=a.slice(1),u=P()(P()({},i),{},{value:null!=o&&o.nested?"".concat(o.nested.path,".").concat(i.value):i.value}),c=$e.literal.toElasticsearchQuery(u),l=(null!==(n=null==t?void 0:t.fields)&&void 0!==n?n:[]).find((function(e){return e.name===c})),d={points:s.map((function(e){return lt(e,t,r,o)}))};if(null!=l&&l.scripted)throw new Error("Geo polygon query does not support scripted fields");return{geo_polygon:v()(v()({},c,d),"ignore_unmapped",!0)}}function Le(e,t){return{arguments:["string"==typeof e?ct(e):ne(e),t]}}function Pe(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=te()(e.arguments,2),i=a[0],s=a[1],u=lt(i),c=null!=o&&null!==(n=o.nested)&&void 0!==n&&n.path?"".concat(o.nested.path,".").concat(u):u;return{nested:{path:c,query:lt(s,t,r,P()(P()({},o),{},{nested:{path:c}})),score_mode:"none"}}}var Me={is:a,and:i,or:s,not:u,range:c,exists:l,geoBoundingBox:d,geoPolygon:f,nested:p};function Ue(e){var t=Me[e];if(U.a.isUndefined(t))throw new Error('Unknown function "'.concat(e,'"'));for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return P()({type:"function",function:e},t.buildNodeParams.apply(t,r))}function Qe(e,t){if(U.a.isUndefined(Me[e]))throw new Error('Unknown function "'.concat(e,'"'));return{type:"function",function:e,arguments:t}}function Ge(e,t,n,r){return Me[e.function].toElasticsearchQuery(e,t,n,r)}function qe(e,t){return{type:"namedArg",name:e,value:"literal"===U.a.get(t,"type")?t:$e.literal.buildNode(t)}}function Be(e){return lt(e.value)}var $e={function:h,literal:r,namedArg:b,wildcard:o},We=n(22),Ke=n.n(We),Ve=n(23),He=n.n(Ve),Ye=n(24),ze=n.n(Ye),Xe=n(25),Ze=n.n(Xe),Je=n(19),et=n.n(Je),tt=n(26),nt=n.n(tt),rt=n(27),ot=n.n(rt);var at=w.i18n.translate("esQuery.kql.errors.endOfInputText",{defaultMessage:"end of input"}),it={fieldName:w.i18n.translate("esQuery.kql.errors.fieldNameText",{defaultMessage:"field name"}),value:w.i18n.translate("esQuery.kql.errors.valueText",{defaultMessage:"value"}),literal:w.i18n.translate("esQuery.kql.errors.literalText",{defaultMessage:"literal"}),whitespace:w.i18n.translate("esQuery.kql.errors.whitespaceText",{defaultMessage:"whitespace"})},st=(Error,n(20)),ut=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:st.parse;if(void 0===e)throw new Error("expression must be a string, got undefined instead");return n(e,P()(P()({},t),{},{helpers:{nodeTypes:$e}}))},ct=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ut(e,P()(P()({},t),{},{startRule:"Literal"}),st.parse)},lt=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0;return t&&t.type&&$e[t.type]?$e[t.type].toElasticsearchQuery(t,n,r,o):e($e.function.buildNode("and",[]),n)};var dt=n(28),ft=n(29),pt=n.n(ft);const ht=w.i18n.translate("xpack.dashboard.components.DashboardDrilldownConfig.chooseDestinationDashboard",{defaultMessage:"Choose destination dashboard"}),bt=w.i18n.translate("xpack.dashboard.components.DashboardDrilldownConfig.useCurrentFilters",{defaultMessage:"Use filters and query from origin dashboard"}),gt=w.i18n.translate("xpack.dashboard.components.DashboardDrilldownConfig.useCurrentDateRange",{defaultMessage:"Use date range from origin dashboard"}),vt=({activeDashboardId:e,dashboards:t,currentFilters:n,keepRange:r,onDashboardSelect:o,onCurrentFiltersToggle:a,onKeepRangeToggle:i,onSearchChange:s,isLoading:u,error:c})=>{var l;const d=(null===(l=t.find((t=>t.value===e)))||void 0===l?void 0:l.label)||"";return Object(T.jsx)(_.a.Fragment,null,Object(T.jsx)(R.EuiFormRow,{label:ht,fullWidth:!0,isInvalid:!!c,error:c},Object(T.jsx)(R.EuiComboBox,{async:!0,selectedOptions:e?[{label:d,value:e}]:[],options:t,onChange:([{value:e=""}={value:""}])=>o(e),onSearchChange:s,isLoading:u,singleSelection:{asPlainText:!0},fullWidth:!0,"data-test-subj":"dashboardDrilldownSelectDashboard",isInvalid:!!c})),!!a&&Object(T.jsx)(R.EuiFormRow,{hasChildLabel:!1},Object(T.jsx)(R.EuiSwitch,{name:"useCurrentFilters",label:bt,checked:!!n,onChange:a})),!!i&&Object(T.jsx)(R.EuiFormRow,{hasChildLabel:!1},Object(T.jsx)(R.EuiSwitch,{name:"useCurrentDateRange",label:gt,checked:!!r,onChange:i})))},mt=(e,t)=>t&&-1===Object(M.findIndex)(e,{value:t.value})?[t,...e]:e,yt=e=>({value:e.id,label:e.attributes.title});class collect_config_container_CollectConfigContainer extends _.a.Component{constructor(e){super(e),v()(this,"isMounted",!0),v()(this,"state",{dashboards:[],isLoading:!1,searchString:void 0,selectedDashboard:void 0,error:void 0}),v()(this,"debouncedLoadDashboards",void 0),this.debouncedLoadDashboards=Object(M.debounce)(this.loadDashboards.bind(this),500)}componentDidMount(){this.loadSelectedDashboard(),this.loadDashboards()}componentWillUnmount(){this.isMounted=!1}render(){const{config:e,onConfig:t}=this.props,{dashboards:n,selectedDashboard:r,isLoading:o,error:a}=this.state;return Object(T.jsx)(vt,{activeDashboardId:e.dashboardId,dashboards:mt(n,r),currentFilters:e.useCurrentFilters,keepRange:e.useCurrentDateRange,isLoading:o,error:a,onDashboardSelect:n=>{t({...e,dashboardId:n}),this.state.error&&this.setState({error:void 0})},onSearchChange:this.debouncedLoadDashboards,onCurrentFiltersToggle:()=>t({...e,useCurrentFilters:!e.useCurrentFilters}),onKeepRangeToggle:()=>t({...e,useCurrentDateRange:!e.useCurrentDateRange})})}async loadSelectedDashboard(){var e;const{config:t,params:{start:n}}=this.props;if(!t.dashboardId)return;const r=await n().core.savedObjects.client.get("dashboard",t.dashboardId);var o;return this.isMounted?404===(null===(e=r.error)||void 0===e?void 0:e.statusCode)?(this.setState({error:(o=t.dashboardId,w.i18n.translate("xpack.dashboard.drilldown.errorDestinationDashboardIsMissing",{defaultMessage:"Destination dashboard ('{dashboardId}') no longer exists. Choose another dashboard.",values:{dashboardId:o}}))}),void this.props.onConfig({...t,dashboardId:void 0})):r.error?(this.setState({error:r.error.message}),void this.props.onConfig({...t,dashboardId:void 0})):void this.setState({selectedDashboard:yt(r)}):void 0}async loadDashboards(e){this.setState({searchString:e,isLoading:!0});const t=this.props.params.start().core.savedObjects.client,{savedObjects:n}=await t.find({type:"dashboard",search:e?`${e}*`:void 0,searchFields:["title^3","description"],defaultSearchOperator:"AND",perPage:100});if(!this.isMounted)return;if(e!==this.state.searchString)return;const r=n.map(yt);this.setState({dashboards:r,isLoading:!1})}}const _t=w.i18n.translate("xpack.dashboard.drilldown.goToDashboard",{defaultMessage:"Go to Dashboard"});class abstract_dashboard_drilldown_AbstractDashboardDrilldown{constructor(e){v()(this,"order",100),v()(this,"getDisplayName",(()=>_t)),v()(this,"euiIcon","dashboardApp"),v()(this,"ReactCollectConfig",void 0),v()(this,"CollectConfig",void 0),v()(this,"createConfig",(()=>({dashboardId:"",useCurrentFilters:!0,useCurrentDateRange:!0}))),v()(this,"isConfigValid",(e=>!!e.dashboardId)),v()(this,"getHref",(async(e,t)=>{const{app:n,path:r}=await this.getLocation(e,t,!0);return await this.params.start().core.application.getUrlForApp(n,{path:r,absolute:!0})})),v()(this,"execute",(async(e,t)=>{const{app:n,path:r,state:o}=await this.getLocation(e,t,!1);await this.params.start().core.application.navigateToApp(n,{path:r,state:o})})),this.params=e,this.ReactCollectConfig=e=>Object(T.jsx)(collect_config_container_CollectConfigContainer,pt()({},e,{params:this.params})),this.CollectConfig=Object(E.reactToUiComponent)(this.ReactCollectConfig)}get locator(){const e=this.params.start().plugins.dashboard.locator;if(!e)throw new Error("Dashboard locator is required for dashboard drilldown.");return e}}const wt=(e,t)=>`drilldown:${t}:${e.eventId}:dashboardId`;class embeddable_to_dashboard_drilldown_EmbeddableToDashboardDrilldown extends abstract_dashboard_drilldown_AbstractDashboardDrilldown{constructor(...e){super(...e),v()(this,"id","DASHBOARD_TO_DASHBOARD_DRILLDOWN"),v()(this,"supportedTriggers",(()=>[O.APPLY_FILTER_TRIGGER])),v()(this,"inject",(({drilldownId:e})=>(t,n)=>{const r=t.action,o=wt(t,e),a=n.find((e=>e.name===o));return a?a.id&&a.id===r.config.dashboardId?t:((e,t)=>({...e,action:{...e.action,config:{...e.action.config,dashboardId:t}}}))(t,a.id):t})({drilldownId:this.id})),v()(this,"extract",(({drilldownId:e})=>t=>{const n=t.action,r=n.config.dashboardId?[{name:wt(t,e),type:"dashboard",id:n.config.dashboardId}]:[],{dashboardId:o,...a}=n.config;return{state:{...t,action:{...t.action,config:a}},references:r}})({drilldownId:this.id}))}async getLocation(e,t,n){const r={dashboardId:e.dashboardId};if(t.embeddable){var o;const n=t.embeddable.getInput();Object(O.isQuery)(n.query)&&e.useCurrentFilters&&(r.query=n.query),Object(O.isTimeRange)(n.timeRange)&&e.useCurrentDateRange&&(r.timeRange=n.timeRange),X(n.filters)&&(r.filters=e.useCurrentFilters?n.filters:null===(o=n.filters)||void 0===o?void 0:o.filter((e=>z(e))))}const{restOfFilters:a,timeRange:i}=Object(O.extractTimeRange)(t.filters,t.timeFieldName);var s;a&&(r.filters=[...null!==(s=r.filters)&&void 0!==s?s:[],...a]);i&&(r.timeRange=i);const u=await this.locator.getLocation(r);return n&&this.useUrlForState(u),u}useUrlForState(e){var t;const n=e.state;e.path=Object(N.setStateToKbnUrl)("_a",Object(dt.cleanEmptyKeys)({query:n.query,filters:null===(t=n.filters)||void 0===t?void 0:t.filter((e=>!z(e))),savedQuery:n.savedQuery}),{useHash:!1,storeInHashQuery:!0},e.path)}}class dashboard_drilldowns_services_DashboardDrilldownsService{bootstrap(e,t,{enableDrilldowns:n}){n&&this.setupDrilldowns(e,t)}setupDrilldowns(e,{uiActionsEnhanced:t}){const n=Object(N.createStartServicesGetter)(e.getStartServices),r=new flyout_create_drilldown_FlyoutCreateDrilldownAction({start:n});t.addTriggerAction(m.CONTEXT_MENU_TRIGGER,r);const o=new flyout_edit_drilldown_FlyoutEditDrilldownAction({start:n});t.addTriggerAction(m.CONTEXT_MENU_TRIGGER,o);const a=new embeddable_to_dashboard_drilldown_EmbeddableToDashboardDrilldown({start:n});t.registerDrilldown(a)}}class plugin_DashboardEnhancedPlugin{constructor(e){v()(this,"drilldowns",new dashboard_drilldowns_services_DashboardDrilldownsService),this.context=e}setup(e,t){return this.drilldowns.bootstrap(e,t,{enableDrilldowns:!0}),{}}start(e,t){return{}}stop(){}}function jt(e){return new plugin_DashboardEnhancedPlugin(e)}}]);